<!--
(c) 2024 Camillo Troiano <camillo.troiano@gmail.com>
This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.
To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/4.0/
or send a letter to Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.
-->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STPD Notes</title>
    <style>
        body, html {
            margin: 0; padding: 0;
            overflow: hidden; height: 100%; display: flex; flex-direction: column;
        }
        canvas {
            flex: 1; display: block; width: 100%; height: 100%;
        }
        #resetButton {
            position: absolute;
            top: 10px; left: 10px; padding: 10px 20px;
            font-size: 16px; cursor: pointer;
        }
    </style>
</head>
<body>
    <canvas id="drawingCanvas"></canvas>
    <button id="resetButton">Reset</button>


<script>
const canvas = document.getElementById('drawingCanvas');
const context = canvas.getContext('2d');
const resetButton = document.getElementById('resetButton');
canvas.width = window.innerWidth; canvas.height = window.innerHeight;
context.strokeStyle = 'black'; context.lineWidth = 2; context.lineCap = 'round';

let isDrawing = false;
canvas.addEventListener('mousedown', startDrawing);
canvas.addEventListener('mousemove', draw);
canvas.addEventListener('mouseup', stopDrawing);
canvas.addEventListener('mouseout', stopDrawing);
canvas.addEventListener('touchstart', startDrawing);
canvas.addEventListener('touchmove', draw);
canvas.addEventListener('touchend', stopDrawing);
canvas.addEventListener('touchcancel', stopDrawing);
resetButton.addEventListener('click', resetCanvas);

function startDrawing(e) {isDrawing = true; context.beginPath(); context.moveTo(getX(e), getY(e));}
function draw(e) {
    if (!isDrawing) return;
    context.lineTo(getX(e), getY(e)); context.stroke(); saveCanvasToLocalStorage();
}
function stopDrawing() {isDrawing = false;}
function getX(e) {return e.touches ? e.touches[0].clientX : e.clientX;}
function getY(e) {return e.touches ? e.touches[0].clientY : e.clientY;}
function resetCanvas() {
    context.clearRect(0, 0, canvas.width, canvas.height);
    localStorage.removeItem('savedCanvas');
}
function saveCanvasToLocalStorage() {
    const dataURL = canvas.toDataURL();
    localStorage.setItem('savedCanvas', dataURL);
}

function loadCanvasFromLocalStorage() {
    const dataURL = localStorage.getItem('savedCanvas');
    if (dataURL) {
        const img = new Image();
        img.src = dataURL;
        img.onload = () => {
            context.drawImage(img, 0, 0, canvas.width, canvas.height);
        };
    }
}

window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    loadCanvasFromLocalStorage();
});
loadCanvasFromLocalStorage();
</script>


</body>
</html>
